<!DOCTYPE html>
<html>
<head>
<title>
Tower Defence by Justin, Kevin, Quentin and Wesley
</title>
<style type="text/css">
body {
    background-color : #FFFFFF;
}
canvas {
    border : 2px solid #FF0000;
    margin-left : auto;
    margin-right : auto;
    display : block
}
</style>
</head>
<body>
<canvas id="myCanvas"></canvas>
<div id="towerinfo">
	Selected tower things
</div>

<script src="lib/jquery.min.js"></script><!-- //ajax.googleapis.com/ajax/libs/jquery/1.8.2/ -->

<!-- MUST BE FIRST OR ELSE THINGS WILL CRASH! -->
<script>
    //Set DFlag.flagName to set debug flags.
    //Try to only do this in debug.js
    var DFlag = {};
</script>

<script src="debug.js"></script>
<script src="fail.js"></script>
<script src="type.js"></script>

<script src="baseGeometry.js"></script>

<script src="commonFncs.js"></script>
<script src="commonGeometry.js"></script>

<script src="baseEntities.js"></script>
<script src="tooltip.js"></script>
<script src="tower.js"></script>
<script src="entities.js"></script>

<script src="quadtree.js"></script>
<script src="quadtreeQueries.js"></script>

<script src="graphics.js"></script>

<script src="pathGeneration.js"></script>

<script src="logic.js"></script>
<script>
    var wTiles = 20;
    var hTiles = 16;
    var tileSize = 32;
    var width = wTiles * tileSize;
    var height = hTiles * tileSize + 200;
    var bW = width;
    var bH = height - 200;
    var mX = -1;
    var mY = -1;

    var gameTimeAccumulated = 0;

    $(document).ready(function () {
        $("#myCanvas").attr("width", width);
        $("#myCanvas").attr("height", height);
        window.reqAnim = (function () {
            return window.requestAnimationFrame ||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame ||
            window.oRequestAnimationFrame ||
            window.msRequestAnimationFrame ||
            function (callback) {
                window.setTimeout(callback, 1000 / 60);
            };
        })();

        canvas = document.getElementById("myCanvas");
        var pen = canvas.getContext("2d");
        eng = new Engine(pen); //this.base.rootNode.holder will also get eng... but... yeah...
        window.reqAnim(eng.run.bind(eng));

        $("#myCanvas").mousemove(function (e) {
            var mX = defined(e.offsetX) ? e.offsetX : e.pageX - document.getElementById("myCanvas").offsetLeft;
            var mY = defined(e.offsetY) ? e.offsetY : e.pageY - document.getElementById("myCanvas").offsetTop;

            eng.mX = mX;
            eng.mY = mY;
        });
        $("#myCanvas").mouseout(function () {
            eng.mX = -1;
            eng.mY = -1;
        });
        $("#myCanvas").mousedown(function (e) {
            var cX = defined(e.offsetX) ? e.offsetX : e.pageX - document.getElementById("myCanvas").offsetLeft;
            var cY = defined(e.offsetY) ? e.offsetY : e.pageY - document.getElementById("myCanvas").offsetTop;

            eng.mdX = cX;
            eng.mdY = cY;
        });
        $("#myCanvas").mouseup(function (e) {
            var cX = defined(e.offsetX) ? e.offsetX : e.pageX - document.getElementById("myCanvas").offsetLeft;
            var cY = defined(e.offsetY) ? e.offsetY : e.pageY - document.getElementById("myCanvas").offsetTop;

            eng.muX = cX;
            eng.muY = cY;
        });
    });
</script>

</body>
</html>
